# å¤§å®éªŒæŠ¥å‘Šï¼šæˆ‘çš„**äº”å­æ£‹AI**
## ä½¿ç”¨è¯´æ˜
1. ç‚¹å‡»`setup.exe` å°†`Five.exe`å®‰è£…åˆ°ä¸`res`æ–‡ä»¶å¤¹åœ¨åŒä¸€ç›®å½•ä¸‹.
2. ç‚¹å‡»`Five.exe`è¿›è¡Œäº”å­æ£‹æ¸¸æˆçš„æ¸¸ç©.
3. æ¸¸ç©æ—¶å¼¹å‡ºå‘½ä»¤æç¤ºè¡Œå±äºæ­£å¸¸ç°è±¡,é‚£é‡Œä¼šæœ‰æ¸¸æˆæ–¹å¼çš„æŒ‡å¯¼çš„.
---
## å†…å®¹è¯´æ˜
### åšä»€ä¹ˆ?
æ—¢ç„¶æ˜¯**äº”å­æ£‹AI**,é‚£å¿…ç„¶æ˜¯è¦åŒ…å«ä»¥ä¸‹å†…å®¹çš„:
1. æ¸¸ç©äº”å­æ£‹çš„æ¡†æ¶
2. äººå·¥æ™ºèƒ½è¯„ä¼°æ£‹å±€ & åŒæ–¹è½å­
æ­¤å¤–æˆ‘è¿˜æ‰©å±•äº†ä¸€äº›åŠŸèƒ½:
3. å¼€å±€ç‚¹å³é”®è®©äººæœºå…ˆä¸‹
4. æ‚”æ£‹, ~~è¿˜å¯ä»¥è¿˜æ²¡ä¸‹æ£‹å°±æ‚”æ£‹,~~ è€Œä¸”å¯ä»¥å›æ»šå¤šæ­¥,ä»æ˜Ÿç½—æ£‹å¸ƒåˆ°è’æ— äººçƒŸéƒ½è¡Œ
    - å½“ç„¶ä¸èƒ½åœ¨è¾“çš„æ—¶å€™æ‚”æ£‹,é‚£å°±æ²¡æ„æ€äº†
5. éƒ¨åˆ†éŸ³æ•ˆ~~(å·çš„ç´ æ)~~
> æœ¬æ¥æƒ³æ·»åŠ èƒŒæ™¯éŸ³ä¹çš„,ä½†æ˜¯è€ƒè™‘åˆ°æœ¬äººæ¯”è¾ƒå–œæ¬¢å¬æ­Œçš„ç¼˜æ•…,æ•…å°†èƒŒæ™¯éŸ³ä¹çš„é€‰æ‹©æƒäº¤ç»™ç©å®¶äº†XD
6. **æ¸¸æˆè§„åˆ™:** äº”å­æ£‹åŸºæœ¬è§„åˆ™(æ— ç¦æ‰‹/æ— æ—¶é—´é™åˆ¶) ~~å› ä¸ºé„™äººå¹¶ä¸æ‡‚äº”å­æ£‹,ä¸‹ä¸è¿‡å°å­¦ç”Ÿé‚£ç§,å› æ­¤å¹¶ä¸éœ€è¦ç¦æ‰‹æ¥åˆ¶çº¦è‡ªå·±å¯æ€œçš„èƒœç‡ç½¢(æ‚²)~~
## æ€ä¹ˆåš?
è¿™é‡Œå°±å¾—è¯¦ç»†è®²äº†.
### å¤‡æˆ˜
#### ä½¿ç”¨å·¥å…·
1. *Visual Studio 2022*(æœ¬æ¥æ˜¯ç”¨vscçš„åˆ äº†,ä½†æ˜¯ä¸å¾—ä¸è£…å›æ¥)
2. *EasyX* å›¾å½¢åº“(å› ä¸ºä¸Šé¢é‚£ä¸ªæ‹¬å·çš„åŸå› å¯¼è‡´è¿™ä¸ªæ’ä»¶è£…äº†ä¸€ä¸ªæ˜ŸæœŸæ‰è£…ä¸Š)
#### åº“
4ä¸ªè‡ªå·±åšçš„å¤´æ–‡ä»¶ç®—**åº“**å—?ğŸ¤”å½“ç„¶*EasyX*è‚¯å®šæ˜¯ç®—çš„
#### é…ç½®å¼€å‘ç¯å¢ƒ
é…ç½®åˆ†ä¸¤æ­¥èµ°,ç¬¬ä¸€æ­¥æŒ‰ç½‘ä¸Šçš„æ•™ç¨‹å°†*Visual Studio*è£…å¥½,ç¬¬äºŒæ­¥å°†*EasyX*å›¾å½¢åº“è£…è¿›*Visual Studio*,å®Œæˆ!
~~å¿˜äº†ç¬¬ä¸‰æ­¥æ–°å»ºæ–‡ä»¶~~
### å®æˆ˜
#### æ¨¡å—åˆ†ç±»
æ‰€è°“**äº”å­æ£‹AI**,é‚£å°±æ˜¯æœ‰**äº”å­æ£‹**å’Œ**AI**ä¸¤éƒ¨åˆ†å˜›.æ ¹æ®äº”å­æ£‹çš„æ€§è´¨,å¯ä»¥åˆ†å‡º**æ£‹å­å’Œæ£‹ç›˜**æ¨¡å—;æ ¹æ®AIçš„ç†è§£,åˆå¯ä»¥åˆ†å‡º**AI**ä¸€ä¸ªæ¨¡å—,å†åŠ ä¸Š**äºº**çš„æ¨¡å—;æ¸¸æˆè¿›è¡Œä¹Ÿéœ€è¦**æ§åˆ¶**æ¨¡å—,é‚£å°±åˆ†ä¸ºå››ä¸ªæ¨¡å—å§!
> æ¯ä¸€ä¸ªæ¨¡å—éƒ½ç¡®å®æ˜¯ä»¥ç±»ä¸ºå•ä½çš„,å°±åƒå¤©ä¸Šåªæœ‰ä¸€ä¸ªå¤ªé˜³
1. `Chess.cpp & Chess.h` æ£‹å­&æ£‹ç›˜æ¨¡å—
2. `ChessGame.cpp & ChessGame.h` æ¸¸æˆæ§åˆ¶æ¨¡å—
3. `AI.cpp & AI.h` äººå·¥æ™ºèƒ½æ¨¡å—
4. `Man.cpp & Man.h` äººç±»åŠŸèƒ½æ¨¡å—
å››ä¸ªæ¨¡å—ä¹‹é—´ç›¸è¾…ç›¸æˆ,å½¼æ­¤ä¾é™„,å°‘äº†ä»»ä½•ä¸€å—æ¸¸æˆéƒ½ä¸èƒ½è¿è¡Œ.æˆ‘è§‰å¾—å°±å¥½æ¯”æ•°å­¦ä¸­çš„å¹¶é›†.
#### å®ç°ä»£ç (**ä¸»è¦**)
> è¿™éƒ¨åˆ†æ˜¯é‡å¤´æˆäº†,å¾—å¥½å¥½è®²è®².ç”±äºç‰ˆé¢åŸå› ,å°±ä¸å±•ç¤ºä¼—å¤šå¤´æ–‡ä»¶çš„å†…å®¹äº†.
åˆ†å®Œç±»ä»¥åå°±æ˜¯è¡¥å……å„ä¸ªæ¥å£çš„ä»£ç å†…å®¹äº†.ä½†è¡¥å……ä¹Ÿå¾—è®²ä¸ªé¡ºåºå§.
0. å„ç§è¦ç´ çš„åˆå§‹åŒ–
	ç±»çš„è°ƒç”¨è‚¯å®šç¦»ä¸å¼€åˆå§‹åŒ–çš„.å› æ­¤,åœ¨æ¯ä¸ªæ¨¡å—å¼€å¤´éƒ½å¿…ç„¶æœ‰ä¸€æ®µ**init**çš„è¿‡ç¨‹.
	`ChessGame.cpp`
	```C++
	ChessGame::ChessGame(Man* man, AI* ai, Chess* chess)
	{
		this->man = man;
		this->ai = ai;
		this->chess = chess;
		man->init(chess);
		ai->init(chess);
	}
	```
	è¿™é‡Œå°±å±•ç¤ºæ§åˆ¶æ¨¡å—çš„åˆå§‹åŒ–,å…¶ä»–ç±»çš„åˆå§‹åŒ–éƒ½å¤§åŒå°å¼‚äº†.
	è¿™æ ·å°±å¯ä»¥è®©å„ä¸ªç±»è”ç³»èµ·æ¥,åŠ²å¾€ä¸€å¤„ä½¿æ‰èƒ½å®Œæˆäº”å­æ£‹çš„å¤§ä¸š.
1. æŠŠæ£‹ç›˜ç”»å‡ºæ¥
	`Chess.cpp`
	```C++
	//è¿™éƒ¨åˆ†ä»£ç æ˜¯ä½äºChess::init()é‡Œé¢çš„
  		//åˆ›å»ºæ¸¸æˆçª—å£
		initgraph(790, 781);
		//æ˜¾ç¤ºæ£‹ç›˜å›¾ç‰‡
		loadimage(0, "res/æ£‹ç›˜4.jpg");
		// åŠ è½½é»‘æ£‹å’Œç™½æ£‹çš„å›¾ç‰‡
		loadimage(&chessBlackImg, "res/black.png", chessSize, chessSize, true);
		//ä½¿å¾—æ£‹ç›˜æ–¹æ ¼å¤§å°ä¸æ£‹å­å¤§å°ç›¸åŒ chessSizeæ˜¯æ ¹æ®æ£‹ç›˜ä¸€ä¸ªå››æ–¹æ ¼çš„å¤§å°æ‰€å®šä¹‰çš„æ£‹å­å¤§å°,å®šä¹‰åœ¨åˆ«çš„åœ°æ–¹
		loadimage(&chessWhiteImg, "res/white.png", chessSize, chessSize, true);
		loadimage(&chessBlackCur, "res/black2.png", chessSize, chessSize, true);
		loadimage(&chessWhiteCur, "res/white2.png", chessSize, chessSize, true);
		loadimage(&chessRed, "res/red.png", chessSize, chessSize, true);
	```
	ç”¨åˆ°çš„æ˜¯EasyXé‡Œé¢çš„å›¾å½¢åº“çš„å„ç§åŠ è½½å›¾å½¢çš„å‡½æ•°,æŠŠæ£‹ç›˜æ£‹å­ç­‰å›¾åƒéƒ½åŠ è½½å‡ºæ¥,æ–¹ä¾¿ä»¥åè°ƒç”¨.èµ„æºæ˜¯è‡ªå·±æ‰¾çš„.
2. è¡¥å……æ£‹ç›˜é€»è¾‘
	å¦‚ä½•å°†æ£‹å­ä¸‹åˆ°æ£‹ç›˜é‡Œ?è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„é—®é¢˜.å°†æ£‹ç›˜æ¡†æ¶è¡¥å……å®Œæ•´,æ‰æœ‰åé¢çš„äººæœºä¸‹æ£‹å¯¹å¼ˆ.é‚£ä¹ˆè¯¥æ€ä¹ˆå®ç°äººç±»çš„è½å­å‘¢?
	- äººç±»ç‚¹å‡»â†’è½å­çš„å®ç°
		`ä¾ç„¶æ˜¯Chess.cpp`
		```C++
		bool Chess::clickBoard(int x, int y, ChessPos* pos)//ChessPos æ˜¯æ£‹å­ä½ç½®çš„ç»“æ„ä½“
		{
			//marginX/Yæ˜¯æ£‹ç›˜è¾¹ç¼˜åƒç´ çš„æ¨ªçºµåæ ‡
			int col = (x - marginX) / chessSize;
			int row = (y - marginY) / chessSize;
			//è¿™ä¸¤æ­¥æ˜¯å…ˆé»˜è®¤ç‚¹å‡»ç‚¹æ˜¯æ£‹ç›˜ä¸­ç¦»é¼ æ ‡æœ€è¿‘çš„å·¦ä¸Šè§’
			int leftTopPosX;
			int leftTopPosY;
			//å‡å»å·¦ä¾§ã€ä¸Šä¾§è¾¹ç•Œ æ•´é™¤æ¯ä¸€æ ¼å®½åº¦ï¼ˆå››èˆäº”å…¥ï¼‰ å°±èƒ½å¾—åˆ°æ¨ªçºµåæ ‡,æ–¹ä¾¿å®šä½è½å­
			int offset = chessSize * 0.4;
			int len;
			mini.data = 789;//éšæ„è®¾çš„ä¸€ä¸ªå€¼,å®ƒæ¯”æ£‹ç›˜æœ¬èº«è¿˜å¤§
			bool ret = false;//æœ¬å‡½æ•°è¿”å›å€¼
			for (int i = 0;i < 4;i++) {
				//ç‚¹å‡»ç‚¹æ˜¯å¦åœ¨å·¦ä¸Šè§’ å·¦ä¸‹è§’ å³ä¸Šè§’ å³ä¸‹è§’çš„åˆ¤å®š
				leftTopPosX = marginX + chessSize * (col + node[i][0]);
				/*
				è¿™é‡Œçš„nodeè¡¨ç¤ºäº†æ¯ä¸€ä¸ªè¾¹è§’,ä¸ºäº†å°†å®ƒå†™è¿›å¾ªç¯é‡Œ,æ˜¾å¾—è¡¨è¾¾å¼æ¯”è¾ƒå¥‡æ€ª å¦‚ä¸‹
				int node[4][2] = { {0,0} , {1,0} , {0,1} , {1,1} };0.å·¦ä¸Šè§’ 1.å·¦ä¸‹è§’ 2.å³ä¸Šè§’ 3.å³ä¸‹è§’
				*/
				leftTopPosY = marginY + chessSize * (row + node[i][1]);
				len = sqrt(pow(x - leftTopPosX, 2) + pow(y - leftTopPosY, 2));
				//æ ¹æ®ç‚¹çš„è·ç¦»å…¬å¼æ±‚å‡ºç‚¹å‡»ç‚¹å’Œ,è¿™é‡Œå°†æœ€å°å€¼å’Œåºå·å¹¶æˆäº†ä¸€ä¸ªç»“æ„ä½“
				if (len <= mini.data) {
					mini.data = len;
					mini.i = i;
				}
			}
			//è®©æœ¬ä½äºå·¦ä¸Šè§’çš„è½å­ç‚¹è½åˆ°ç²¾ç¡®çš„ä½ç½®
			col += node[mini.i][0];
			row += node[mini.i][1];
			pos->col = col;
			pos->row = row;
			if (!chessMap[pos->row][pos->col]) {
				ret = true;
				//å¦‚æœè¿™ä¸ªåœ°æ–¹å·²ç»æœ‰å­äº†,å°±ä¸èƒ½è½å­äº†.
			}
			return ret;
		}
		```
	- è®©è½å­å…·è±¡åŒ–(æœ‰å›¾åƒå’Œå£°éŸ³)
		äº‹å®ä¸Š,å…‰ç‚¹å‡»äº†æ£‹ç›˜å…¶å®å¹¶ä¸èƒ½è®©æ£‹å­*çœ‹èµ·æ¥*è½åœ¨æ£‹ç›˜ä¸Š,å› ä¸ºæ­¤æ—¶è¿˜æ²¡æœ‰åŠ è½½æ£‹å­çš„å›¾ç‰‡.å› æ­¤åˆæœ‰:
		`Chess.cpp`
		```C++
		void Chess::chessDown(ChessPos* pos, chess_kind_t kind/*æ£‹å­çš„ç§ç±»*/)
		{
			mciSendString("play res/down7.wav", 0, 0, 0);//è½å­éŸ³æ•ˆ
			int x = marginX + chessSize * pos->col - 0.5 * chessSize;
			int y = marginY + chessSize * pos->row - 0.5 * chessSize;
			//è®©è½å­è½åœ¨çºµæ¨ªçº¿ä¸­é—´
		//	if (kind == CHESS_WHITE)
		//		putimagePNG(x, y, &chessWhiteImg);
		//	else putimagePNG(x, y, &chessBlackImg);
			//è¿™æ®µæ³¨é‡Šæ˜¯ä»¥å‰æ˜¾ç¤ºè½å­çš„æ–¹å¼,åæ¥ä¸ºäº†åŠ å…¥æ‚”æ£‹ç­‰åŠŸèƒ½,æ”¹ä¸ºæ¯è½ä¸€æ¬¡å­å°±åˆ·æ–°äº†ä¸€æ¬¡ç”»é¢
			updateGameMap(pos);
			drawMap();
		}
		void Chess::updateGameMap(ChessPos* pos)
		{
			lastPos = *pos;//è®°å½•ä¸Šä¸€æ¬¡è½å­çš„ä½ç½®
			chessRecord.push(lastPos);//å°†ä¸Šæ¬¡è½å­ä½ç½®å‹å…¥æ ˆå†…,æ–¹ä¾¿æ‚”æ£‹å¯»æ‰¾
			if (firstStrike)//firstStrikeæ˜¯è°å…ˆæ‰‹çš„æ„æ€.
				chessMap[pos->row][pos->col] = playerFlag ? CHESS_BLACK : CHESS_WHITE;
				//è°å…ˆæ‰‹è°æ˜¯é»‘å­,ç„¶åæ ¹æ®è½å­æ–¹åŠ è½½é‚£ä¸€æ–¹çš„å›¾ç‰‡
			else
				chessMap[pos->row][pos->col] = playerFlag ? CHESS_WHITE : CHESS_BLACK;
			playerFlag = !playerFlag;
			//playerFlagæ˜¯è½å­æ–¹çš„åˆ¤æ–­,æ­¤æ—¶æ˜¯ä¸ºäº†äº¤æ¢è½å­æ–¹çš„è¡¨è¿°
		}
		void Chess::drawMap()
		{
			cleardevice();//EasyXçš„æ¸…å±æ“ä½œ
			loadimage(0, "res/æ£‹ç›˜4.jpg");
			for (int i = 0;i < gradeSize;i++) {
				for (int j = 0;j < gradeSize;j++) {
					//å¯¹äºæ£‹ç›˜ä¸Šæ¯ä¸€ä¸ªå­,å‡æŠŠå®ƒä»¬åŠ è½½åˆ°æ£‹ç›˜ä¸Š
					int x = marginX + chessSize * j - 0.5 * chessSize;
					int y = marginY + chessSize * i - 0.5 * chessSize;
					switch (chessMap[i][j])//chessMap,äºŒç»´æ•°ç»„å­˜å‚¨æ¸¸æˆåœ°å›¾
					{
					case 1://1,å³CHESS_BLACK,æ˜¯é»‘æ£‹çš„ä»£è¡¨ 
						putimagePNG(x, y, (i == lastPos.row && j == lastPos.col) ? &chessBlackCur : &chessBlackImg);
						break;
					case -1://-1,å³CHESS_WHITE,æ˜¯ç™½æ£‹çš„ä»£è¡¨
						putimagePNG(x, y, (i == lastPos.row && j == lastPos.col) ? &chessWhiteCur : &chessWhiteImg);
						break;
					case 2://2æ˜¯çº¢æ£‹,ä¸€æ–¹äº”å­è¿ç åæ˜¾ç¤º,æ¸¸æˆç»“æŸ
						putimagePNG(x, y, &chessRed);
						break;
					}
				}
			}
		}
		```
		è¿™æ ·,ç”±**ç‚¹å‡»â†’è½å­â†’è®°å½•â†’ä¸Šå›¾**,è½å­çš„åŠŸèƒ½å°±å¯ä»¥å®ç°äº†.åœ¨æ£‹å­è¿™æ–¹é¢è®¾è®¡å®Œæ¯•å,è¿˜éœ€è¦åœ¨äººç±»å’Œäººæœºé‚£è¾¹é…åˆä¸€ä¸‹æ¥å£æ‰è¡Œ.äººæœºçš„è½å­åªéœ€è¦å»æ‰**ç‚¹å‡»**è¿™ä¸€æ­¥å°±è¡Œ.
		`è¿™æ¬¡æ˜¯Man.cpp`
		```C++
		void Man::go()
		{
			MOUSEMSG msg;//è·å–é¼ æ ‡ç‚¹å‡»ä¿¡æ¯
			ChessPos pos;
			//é€šè¿‡chesså¯¹è±¡æ¥è°ƒç”¨åˆ¤æ–­è½å­æ˜¯å¦æœ‰æ•ˆï¼Œä»¥åŠè½å­åŠŸèƒ½
			bool mouse;
			while (1) {
				msg = GetMouseMsg();
				if (msg.uMsg == WM_RBUTTONDOWN) {
					mouse = false;//æ‚”æ£‹æŒ‰é’®
					break;
				}
				if (msg.uMsg == WM_LBUTTONDOWN && chess->clickBoard(msg.x, msg.y, &pos)) {
					mouse = true;//è½å­æŒ‰é’®
					break;
				}
			}
			system("cls");//åé¢ä¼šæ˜¾ç¤ºAIè®¡åˆ†åœ°å›¾,æ¸…å±æ˜¯ä¸ºäº†åˆ·æ–°
			//ä¸‹é¢æ˜¯é»‘æ£‹è½å­æˆ–è€…æ‚”æ£‹
			if (mouse)
				chess->chessDown(&pos, CHESS_BLACK);
			else chess->recall();//é»‘å­æ‚”æ£‹
		}
		```
		`ç„¶åæ˜¯AI.cpp`
		```C++
		void AI::go()
		{
			ChessPos pos;
			if (chess->chessRecord.empty()) {
				pos.col = 7;
				pos.row = 7;
			}//å¦‚æœç™½æ£‹å…ˆæ‰‹,é‚£ä¹ˆé»˜è®¤è½åœ¨ä¸­å¤®
			else {
				pos = think();
				srand((unsigned)time(NULL));
				int stime = rand() % 3000;
				Sleep(stime);
				//è®¡ç®—æœºå‡è£…æ€è€ƒé™ªäººç±»ç©ä¸€ä¸‹
			}
			chess->chessDown(&pos, CHESS_WHITE);
		}
		```
		é—®é¢˜æ¥äº†,ä¸Šæ–‡è¿˜æœ‰ä¸€ä¸ªputimagePNG()å‡½æ•°,è¿™æ˜¯ä»€ä¹ˆå‡½æ•°?ä¼—æ‰€å‘¨çŸ¥,EasyXå›¾å½¢åº“æ˜¾ç¤ºçš„å›¾ç‰‡å¹¶ä¸æ˜¯é€æ˜çš„,è¿™ä¼šè®©ä¸‹æ£‹çš„è§‚æ„Ÿå˜å¾—å¾ˆå·®.å› æ­¤æˆ‘å¼•ç”¨äº†[è¿™ä¸ªåœ°æ–¹çš„é€æ˜åŒ–PNGå‡½æ•°](https://blog.csdn.net/pzjdoytt/article/details/125198101),å¿«é€Ÿæ¶ˆé™¤å›¾ç‰‡å‘¨å›´çš„ç™½æ¡†,èˆ’æœå¤šäº†.è¿™é‡Œå°±ä¸å†å±•ç¤ºè¿™ä¸ªé€æ˜å‡½æ•°äº†.
		è‡³æ­¤,æ¸¸æˆçš„åº•å±‚æ¡†æ¶å·²å·®ä¸å¤šå†™å®Œäº†.
3. è¡¥å……æ¸¸æˆæ§åˆ¶éƒ¨åˆ†
	äº”å­æ£‹æ˜¯å›åˆåˆ¶æ¸¸æˆ,æ¸¸æˆæ§åˆ¶å¾ˆç®€å•:ä½ ä¸€æ­¥,æˆ‘ä¸€æ­¥.
	`ChessGame.cpp`
	```C++
	//å¯¹å±€ï¼ˆå¼€å§‹äº”å­æ£‹æ¸¸æˆï¼‰
	void ChessGame::play()
	{
		chess->init();//åˆå§‹åŒ–å°‘ä¸äº†
		while (1) {
			//å…ˆç”±æ£‹æ‰‹è½å­
			if (chess->playerFlag) {
				man->go();
				if (chess->checkOver()) {
					//checkOver()å‡½æ•°æ£€æŸ¥æ˜¯å¦æœ‰äº”å­è¿ç ,è‹¥æœ‰,è¿›è¡Œä¸‹ä¸€å±€æ¸¸æˆ
					chess->init();
					continue;
				}
			}
			//å†ç”±æœºå™¨è½å­
			if (!chess->playerFlag) {
				ai->go();
				if (chess->checkOver()) {
					chess->init();
					continue;
				}
			}
		}
	}
	```
	æ­¤æ—¶**äº”å­æ£‹**å·²ç»å¯ä»¥ä¸‹äº†.ä½†æ˜¯æœ‰ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜:ç°åœ¨AIè¿˜ä¸ä¼šæ€è€ƒ,ç°åœ¨åªæ˜¯äººç±»åœ¨è‡ªå¨±è‡ªä¹è€Œå·².é‡ä¸­ä¹‹é‡æ¥äº†:è®¾è®¡AIç®—æ³•.
4. å®Œå–„AIè½å­éƒ¨åˆ†
	æ€ä¹ˆè®©AIåŠ¨èµ·æ¥?æ–¹æ³•æœ‰å¾ˆå¤šç§,è¿™é‡Œæˆ‘é‡‡å–çš„æ˜¯å…¶ä¸­æ¯”è¾ƒç®€å•çš„ä¸€ç§:è®¡ç®—åœ°å›¾ä¸Šæ¯ä¸€ç‚¹çš„å¾—åˆ†.å¯¹äºè®©AIè¡ŒåŠ¨æ–¹æ³•çš„è®¨è®ºæˆ‘ä¼šæ”¾åˆ°è¯„ä¼°AIæ£‹åŠ›çš„éƒ¨åˆ†é‡Œé¢.è¿™é‡Œå…ˆè°ˆè°ˆæ€ä¹ˆè®©AIæ€è€ƒ.
	- åˆå§‹åŒ–
		åŒ…æ‹¬ç±»çš„åˆå§‹åŒ–,å¯åŠ¨AIè®¡åˆ†åœ°å›¾ç­‰.
		`AI.cpp(æ¥ä¸‹æ¥éƒ½æ˜¯)`
		```C++
		void AI::init(Chess* chess)
		{
			this->chess = chess;
			int size = chess->getGradeSize();//è·å–æ£‹ç›˜å¤§å°
			for (int i = 0;i < size;i++) {
				vector<int> row;
				for (int j = 0;j < size;j++) {
					row.push_back(0);
				}
				scoreMap.push_back(row);//åˆ›å»ºè®¡åˆ†åœ°å›¾äºŒç»´åŠ¨æ€æ•°ç»„
			}
		}
		```
	- å¡«å……è®¡åˆ†åœ°å›¾å¹¶å–æœ€å¤§å€¼
		æˆ‘çš„AIçš„æ€è€ƒæ–¹å¼:å¯¹äºæ¯ä¸€ä¸ªç©ºä½,è‹¥AIé€‰æ‹©è½åœ¨è¿™ä¸ªä½ç½®,å¯¹æ¨ªçºµæ–œå››ä¸ªæ–¹å‘åˆ†åˆ«è¯„ä¼°å…¶å¯å½¢æˆçš„æ£‹å‹,å¯¹äºæ¯ä¸€ç§æ£‹å‹ç»™äºˆä¸€å®šçš„æ¢¯åº¦åˆ†æ•°,å°†å››ä¸ªæ–¹å‘çš„åˆ†æ•°åŠ èµ·æ¥å³ä¸ºæœ¬ä½ç½®å¾—åˆ†.å¦‚æ­¤æ“ä½œç›´åˆ°åœ°å›¾è¢«å¡«æ»¡,ç„¶åéšæœºå–å¾—åˆ†æœ€å¤§å€¼çš„ä½ç½®ä¹‹ä¸€è½å­.
		```C++
		//è®¡ç®—æ¯ä¸€ä¸ªç©ºä½çš„å¾—åˆ†
		void AI::calculateScore()
		{
			//è¯„åˆ†æ•°ç»„æ¸…é›¶
			for (int i = 0;i < scoreMap.size();i++) {
				for (int j = 0;j < scoreMap[i].size();j++) {
					scoreMap[i][j] = 0;
				}
			}
			ChessPos pos_t, curPos;
			//pos_t:ä¸ºäº†è¯„ä¼°æ£‹å‹æ‰€å®šä¹‰çš„æ´»åŠ¨ä½ç½®;curPos:å½“å‰è¯„ä¼°ä½ç½®
			int score[2][2][5] = 
			{ 
				{ { 0,10,30,60,20000 }/*ä¸€ä¸ªç©ºç™½ä½ç½®*/,{ 0,10,40,150,20000 }/*ä¸¤ä¸ªç©ºç™½ä½ç½®*/ }, //é»‘æ£‹
				{ { 5,10,50,200,30000 }/*ä¸€ä¸ªç©ºç™½ä½ç½®*/,{ 5,10,75,10000,30000 }/*ä¸¤ä¸ªç©ºç™½ä½ç½®*/ },//ç™½æ£‹
			};
			//è®¡åˆ†æ•°è¡¨;è¡¨ç¤ºçš„å«ä¹‰â†’ç¬¬ä¸€ç»´åº¦ï¼šé»‘ç™½æ£‹0/1ï¼›ç¬¬äºŒç»´åº¦0/1ï¼šç©ºç™½ä½ç½®ä¸ªæ•°-1ï¼›ç¬¬ä¸‰ç»´åº¦ï¼šæ£‹å­ä¸ªæ•°å¯¹åº”çš„è¯„åˆ†	
			int size = chess->getGradeSize();
			for (curPos.row = 0;curPos.row < size;curPos.row++) {
				for (curPos.col = 0;curPos.col < size;curPos.col++) {
					//å¯¹æ¯ä¸ªæ£‹ç›˜ä¸Šçš„ç‚¹è®¡ç®—
					if (chess->getChessData(&curPos) != 0) continue;//æ£‹ç›˜ä¸Šè¿™ç‚¹ä¸ºç©º æ‰è®¡ç®—
					for (int y = -1;y <= 1;y++) {
						for (int x = 0;x <= 1;x++) {
							//xå’Œyæ˜¯ä¸ºäº†ç¡®å®šæ£‹å‹æ—¶æ´»åŠ¨æ–¹å‘çš„"å‘é‡"
							int personNum = 0/*é»‘æ£‹åœ¨è¿™ä¸ªæ–¹å‘ä¸Šè¿ç»­æœ‰å¤šå°‘ä¸ªæ£‹å­*/, AINum = 0,/*ç™½æ£‹åœ¨è¿™ä¸ªæ–¹å‘ä¸Šæœ‰å¤šå°‘ä¸ªè¿ç»­çš„æ£‹å­*/emptyNum = 0;//è¯¥æ–¹å‘ä¸Šç©ºç™½ä½ç½®çš„ä¸ªæ•°
							if (x == 0 && y == 0) continue;//0,0 ä¸æ´»åŠ¨ æ’é™¤
							if (y == -1 && x == 0) continue;//-1,0 ä¸åˆè¦æ±‚æ’é™¤
							//è‡³æ­¤å››ä¸ªæ–¹å‘éƒ½å¯ä»¥è¢«è¯„ä¼°æ£‹å‹äº†
							//ä¸‹é¢æ˜¯å‡è®¾äººç±»åœ¨è¯¥ä½ç½®è½å­ä¼šæ„æˆäººç±»çš„ä»€ä¹ˆæƒ…å½¢
							for (int dir = -1;dir <= 1;dir += 2) {
								//æ´»åŠ¨æ–¹å‘:æ­£è´Ÿä¸¤ä¸ªæ–¹å‘éƒ½è¦å–
								for (int i = 1;i <= 4;i++) {
									pos_t.row = curPos.row + i * y * dir;
									pos_t.col = curPos.col + i * x * dir;
									//ä»å½“å‰ä½ç½®å‘ç”Ÿæ´»åŠ¨ä½ç§»ä»¥è¯„ä¼°æ£‹å‹
									if (posJudge(pos_t, CHESS_BLACK)) {
										//posJudgeå‡½æ•°å¯ä»¥åˆ¤å®šå½“å‰ä½ç½®æ˜¯å¦ä½äºæ£‹ç›˜å†…ä¸”æ˜¯å¦æ»¡è¶³ç±»å‹(é»‘ç™½)è¦æ±‚,è‹¥æ»¡è¶³,å¯¹åº”è¿ç»­æ£‹å­æ•°+1
										personNum++;
									}
									else if (posJudge(pos_t, EMPTY)) {
										//å¦‚æœé‡åˆ°ç©ºç™½åˆ™åœæ­¢è®¡æ•°.æœ€ç»ˆå¯ä»¥å¾—åˆ°
										emptyNum++;
										break;
									}
									else {
										//å‡ºè¾¹ç•Œå°±å‡ºå¾ªç¯
										break;
									}
								}
							}
							if (personNum == 1 || personNum == 4) {
								//å¯¹äºäººç±»,ä¸ºå½“å‰ä½ç½®è¯„åˆ†
								scoreMap[curPos.row][curPos.col] += score[0][0][personNum];
								//è¿™é‡ŒåŒºåˆ†äººç±»è¿å­æ•°1å’Œ4ä¸ºä¸€ä¸ªåˆ†æ”¯æ¡ä»¶,æœ‰ä¸¤ç§åŸå› :æ­¤æ—¶ç©ºç™½ä½ç½®å¯èƒ½ä¸º0ä½¿å¾—æ•°ç»„è¶Šç•Œ;æˆ–è€…æ— è®ºç©ºç™½ä½ç½®æœ‰å¤šå°‘è¯„åˆ†å¢åŠ å€¼å‡ç›¸åŒ.
							}
							else if (emptyNum == 1 || emptyNum == 2) {
								//else ifçš„æ¡ä»¶ç¡®ä¿åŠ åˆ†æ—¶æ•°ç»„ä¸è¶Šç•Œ
								scoreMap[curPos.row][curPos.col] += score[0][emptyNum - 1][personNum];
								//è¯„åˆ†æ•°ç»„ç«‹å¤§åŠŸ,é¿å…å¤§é‡çš„é‡å¤å½±å“è§‚æ„Ÿ
							}
							emptyNum = 0;
							//è®©ç©ºç™½ä½ç½®é‡ç½®,ä¸‹é¢æ˜¯ä¸ºAIæ£‹å­è¯„åˆ†éƒ¨åˆ†,åŒç†
							for (int dir = -1;dir <= 1;dir += 2) {
								for (int i = 1;i <= 4;i++) {
									pos_t.row = curPos.row + i * y * dir;
									pos_t.col = curPos.col + i * x * dir;
									if (posJudge(pos_t, CHESS_WHITE)) {
										AINum++;
									}
									else if (posJudge(pos_t, EMPTY)) {
										emptyNum++;
										break;
									}
									else {
										break;
									}
								}
							}
							if (AINum <= 1 || AINum >= 4) {
								scoreMap[curPos.row][curPos.col] += score[1][0][AINum];
							}
							else if (emptyNum == 1 || emptyNum == 2) {
								scoreMap[curPos.row][curPos.col] += score[1][emptyNum - 1][AINum];
							}
						}
					}
				}
			}
		}
		//AIå°†æ ¹æ®è¯„åˆ†åœ°å›¾æ€è€ƒå†³ç­–è½å­ä½ç½®(å–æœ€å¤§å€¼,è‹¥æœ‰å¤šä¸ª,éšæœºå–ä¹‹ä¸€)
		ChessPos AI::think()
		{
			AI::calculateScore();//è®¡ç®—å¾—åˆ†
			ChessPos pos = { 0,0 };
			int maxScore = 0;//è®°å½•æœ€å¤§å€¼
			vector<ChessPos> record;//è®°å½•æœ€å¤§å€¼å¾—åˆ†æ‰€åœ¨ä½ç½®çš„åŠ¨æ€æ•°ç»„
			//ä¸‹é¢æ˜¯æ‰“å°AIè¯„åˆ†åœ°å›¾çš„ä»£ç ,ä»¥ä¾›å‚è€ƒ
			printf("      ");
			for (int i = 65;i < scoreMap.size()+65;i++) {
				printf("%-6c", i);
			}
			cout << endl;
			for (int j = 0;j < scoreMap.size();j++) {
				printf("%-6d", j+1);
				//ä¸‹é¢æ˜¯è®°å½•æœ€å¤§å€¼çš„ä»£ç 
				for (int i = 0;i < scoreMap.size();i++) {
					printf("%-6d", scoreMap[j][i]);
					if (maxScore < scoreMap[j][i]) {
						record.clear();//æ—¢ç„¶æœ€å¤§å€¼å·²è¢«åˆ·æ–°,ä¹‹å‰çš„è®°å½•å°±å…¨æ²¡ç”¨äº†
						pos.row = j;
						pos.col = i;
						record.push_back(pos);//å°†æœ€å¤§å€¼çš„ä½ç½®å‹å…¥è®°å½•ä¸­
						maxScore = scoreMap[j][i];
					}
					else if (maxScore == scoreMap[j][i]) {
						pos.row = j;
						pos.col = i;
						record.push_back(pos);//å°†æœ€å¤§å€¼ä¹‹ä¸€çš„ä½ç½®å‹å…¥è®°å½•ä¸­
					}
				}
				cout << endl;
			}
			printf("maxscore:%d\n", maxScore);
			//æ­¤å¤„è¯„åˆ†
			srand((unsigned)time(NULL));//å–éšæœºæ•°
			int index = rand() % record.size();
			return record[index];//éšæœºè½å­åœ¨ä¸€ä¸ªæœ€å¤§å€¼æ‰€åœ¨ä½ç½®
		}
		```
	- AIè½å­
		è¿™éƒ¨åˆ†å·²ç»åœ¨**2.**é‡Œé¢æ¶‰åŠåˆ°äº†,ä¹Ÿå°±æ˜¯`void AI::go()`å‡½æ•°.å°±ä¸å†é‡å¤äº†.
5. åˆ¤å®šç»“æŸå’Œèƒœè´Ÿ
	åªè¦åœºä¸Šå‡ºç°ä¸€æ–¹**äº”å­è¿ç **,æ¸¸æˆç»“æŸ.å¯¹äºäº”å­è¿ç çš„åˆ¤æ–­ä¸å¿…åƒè®¡ç®—AIåœ°å›¾é‚£æ ·éå†æ‰€æœ‰ç©ºé—²ç‚¹,åªéœ€è¦æœç´¢ä¸Šæ¬¡è½å­çš„ä½ç½®ä¸Šä¸‹å·¦å³å¯¹è§’çº¿æ–¹å‘æ˜¯å¦æœ‰**äº”ä¸ªç›¸åŒç±»å‹çš„æ£‹å­**(ä¸ä¸ºç©º)å°±è¡Œäº†.
	`Chess.cpp`
	```C++
	bool Chess::checkWin()
	{
		int row = lastPos.row;//lastPosä¸Šæ¬¡è½å­çš„ä½ç½®
		int col = lastPos.col;
		for (int x = 0;x <= 1;x++) {
			for (int y = -1;y <= 1;y++) { //ç»å…¸çš„æ–¹å‘å†³å®šå¼å­ x å’Œ y
			//içš„æ„æ€æ˜¯åœ¨è¿ç»­äº”ä¸ªç‚¹
				if ((x == 0 && y == 0) || (x == 0 && y == -1)) continue;//åƒä¸Šé¢AIåœ°å›¾ä¸€æ ·,æ’é™¤ä¸¤ä¸ªä¸éœ€è¦çš„æ–¹å‘	
				for (int i = 0;i < 5;i++) {
					//ä¸€æ¬¡åˆ¤æ–­ï¼Œå…±4æ¬¡ï¼Œè¿ç»­5å­å‡åŒè‰²åˆ™æ¸¸æˆç»“æŸ
					int cnt = 0;
					ChessPos pos;//æ¯ä¸€æ¬¡è¿ç»­ç¡®è®¤çš„èµ·ç‚¹
					pos.row = row - i * y;
					pos.col = col - i * x;
					if (!borderCheck(pos.row, pos.col) || !borderCheck(pos.row + 4 * y, pos.col + 4 * x)) {
						//é˜²æ­¢æ•°ç»„è¶Šç•Œ,è¶…å‡ºåœ°å›¾ä¹‹å¤–çš„åˆ¤æ–­
						continue;
					}
					for (int j = 1;j <= 4;j++) {
						if (chessMap[pos.row][pos.col] == chessMap[pos.row + j * y][pos.col + j * x] && chessMap[pos.row][pos.col] != 0) {
							//åˆ¤æ–­è¿ç»­ä½ç½®æ˜¯å¦ä¸ºåŒä¸€ç±»å‹
							cnt++;
						}
					}
					if (cnt == 4) {
						showResult(x, y, pos);//åæ–‡ä¼šæ¶‰åŠåˆ°çš„å±•ç¤ºç»“æœå‡½æ•°
						cout << "Gameover!" << endl;
						return true;
					}
				}
			}
		}
		return false;
	}
	```
	åé¢æ˜¾ç¤ºèƒœè´Ÿé¡µé¢çš„ä»£ç å°±ä¸å±•ç¤ºäº†.
6. è¡¥å……åŠŸèƒ½
	- æ˜¾ç¤ºäº”å­è¿ç 
	å› ä¸ºæˆ‘æ¯”è¾ƒèœ,æœ‰æ—¶å€™è¾“äº†éƒ½ä¸çŸ¥é“æ€ä¹ˆè¾“çš„,æ‰€ä»¥æˆ‘éœ€è¦çŸ¥é“æˆ‘è¾“åœ¨å“ªé‡Œ~~(å½“ç„¶ä¹Ÿå¯ä»¥æ˜¯èµ¢åœ¨å“ªé‡Œ)~~,å› æ­¤è®¾è®¡äº†æ˜¾ç¤ºèµ¢æ£‹çš„éƒ¨åˆ†.
	```C++
	void Chess::showResult(int x,int y,ChessPos pos)
	{
		if (borderCheck(pos.row, pos.col) && borderCheck(pos.row + 4 * y, pos.col + 4 * x)) {
			for (int i = 0;i < 5;i++) {
				chessMap[pos.row + i * y][pos.col + i * x] = 2;
			}
			drawMap();//åŠ è½½å‡ºæ£‹ç›˜å’Œæ£‹å­çš„å›¾ç‰‡
			Sleep(3000);//3ç§’é’Ÿæ˜ç™½18ç§è¾“æ³•
		}
	}
	```
	- æ‚”æ£‹,å’Œè®©AIå…ˆæ‰‹çš„åŠŸèƒ½
	å› ä¸ºæˆ‘æ¯”è¾ƒèœ,å¾ˆå®¹æ˜“çœ‹æ¼æ£‹å­å¯¼è‡´å¤±è¯¯é€èµ¢,è€Œä¸”**æµ‹è¯•çš„æ—¶å€™ä¹Ÿéœ€è¦å¤šæ­¥å›æ»šçœ‹è®°å½•**,æ‰€ä»¥è®¾è®¡äº†æ‚”æ£‹çš„åŠŸèƒ½.
	æ‚”æ£‹çš„ä¸»è¦æ€æƒ³å…¶å®å’Œæµè§ˆæ–‡ä»¶å¤¹é‡Œé¢çš„`è¿”å›`æ˜¯å·®ä¸å¤šçš„,éƒ½æ˜¯å°†è®°å½•å‹å…¥å’Œé€€å‡ºæ ˆçš„è¿‡ç¨‹.çŸ¥é“è¿™ä¸€ç‚¹å,æ‚”æ£‹å°±ä¸éš¾è®¾è®¡äº†.
	```C++
	void Chess::recall()
	{
		if (chessRecord.empty()) {
			//å¦‚æœå¼€å±€æ‚”æ£‹,åˆ™è§†ä¸ºè®©æœºå™¨å…ˆæ‰‹
			playerFlag = !playerFlag;
			firstStrike = false;
			return;
		}
		else if (chessRecord.size() == 1) {
			//å¦‚æœåœ¨æœºå™¨å…ˆæ‰‹çš„æ—¶å€™é€‰æ‹©æ‚”æ£‹,å–æ¶ˆæ­¤æ“ä½œ
			cout << "ä½ ç°åœ¨ä¸èƒ½æ’¤å›ï¼è¯·å…ˆä¸‹ç¬¬ä¸€æ­¥æ£‹ã€‚" << endl;
			return;
		}	
		for (int i = 0;i < 2;i++) {
			int row = chessRecord.top().row;
			int col = chessRecord.top().col;
			chessMap[row][col] = 0;
			chessRecord.pop();
			//åˆ é™¤è®°å½•å³å¯,ç”šè‡³ä¸éœ€è¦äº¤æ¢æ£‹æƒ
		}
		drawMap();//é‡æ–°ç»˜åˆ¶æ£‹ç›˜å’Œæ£‹å­çš„å›¾ç‰‡
	}
	```
**è·Œè·Œæ’æ’ä¸­å¥½åƒäº”å­æ£‹AIå°±åšå®Œäº†.**
#### è¿è¡Œ
1. è¿è¡Œæˆªå›¾
	![å¼€å§‹ç•Œé¢](/pic1.png)
	![å·²ç»ç»“æŸå’§](/pic2.png)
	![AIåœ°å›¾æ˜¾ç¤º](/pic3.png)
2. ç¨‹åºè¿è¡Œé€Ÿåº¦
	emmè¿™ä¸ªæ€ä¹ˆè¯´å‘¢,ä½ è¯´å®ƒå¿«å§,æœ‰æ—¶å€™ä¼šé—ªå±,åº”è¯¥æ˜¯*EasyX*çš„åŸå› ;ä½ è¯´å®ƒå¡å§,è½å­ç§’ä¸‹åˆæ˜¯çœŸçš„.æˆ‘è§‰å¾—ä¸‹äº”å­æ£‹åº”è¯¥ç”¨ä¸åˆ°å¸§ç‡æ¥æè¿°å§!AIæ€è€ƒåˆä¸éœ€è¦æ—¶é—´,ä¸€åˆ‡éƒ½æ˜¯Sleep()çš„é”™!(ç¬‘)
3. ç¨‹åºå¤§å°
	çº¦5M,å…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯å›¾ç‰‡éŸ³æ•ˆèµ„æºå ç”¨ç©ºé—´,ä»£ç æœ¬èº«å½“ç„¶æ˜¯ä¸å ç©ºé—´çš„.
#### æ£‹åŠ›è¯„ä»·